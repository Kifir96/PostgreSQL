CREATE TABLE Users(
userid serial PRIMARY KEY,
age INTEGER);
  
CREATE TABLE Items(
itemid serial PRIMARY KEY,
price integer not null); 

CREATE TABLE Purchases(
purchaseid serial PRIMARY KEY,
userid integer NOT NULL,
itemid integer NOT NULL,
foreign key (userid) REFERENCES Users(userid),
foreign key (itemid) REFERENCES Items(itemid),
purchase_date date not NULL);


--Данные для заполнения сгененрировал в прогрмамме:
/*
from random import randint, choice

for i in range(100):
    age = randint(18, 60)
    print(f"({age}),", end=' ')

for i in range(500):
    price = randint(10, 9999)
    print(f"({price}),", end=' ')


for i in range(1000):
    userid = randint(1, 100)
    itemid = randint(1, 500)
    day = randint(1, 28)
    month = randint(1, 12)
    year = choice([2019, 2020, 2021])
    print(f"({userid}, {itemid}, '{month}/{day}/{year}'),", end=' ')
*/
    
INSERT INTO Users(age)
VALUES
(19), (59), (24), (36), (43), (60), (54), (25), (32), (32), (44), (21), (48), (35), (41), (48), (48), (36), (31), (57), (31), (54), (59), (19), (30), (19), (20), (57), (25), (51), (23), (53), (20), (59), (53), (26), (44), (31), (21), (35), (52), (31), (31), (51), (19), (47), (28), (32), (28), (23), (33), (27), (55), (45), (22), (54), (59), (51), (26), (20), (41), (58), (35), (36), (31), (57), (20), (22), (44), (24), (22), (39), (58), (27), (50), (38), (51), (43), (41), (45), (39), (54), (45), (37), (53), (53), (34), (58), (54), (21), (36), (26), (31), (42), (38), (34), (46), (29), (25), (59);
    
INSERT into items(price)
VALUES
(3803), (4259), (258), (8964), (268), (7841), (2998), (58), (7131), (7222), (7447), (6708), (1350), (5563), (5097), (7480), (3219), (2226), (9155), (6325), (9086), (4836), (3872), (6835), (941), (7767), (2005), (5646), (6110), (2439), (7161), (9651), (8373), (654), (2064), (9440), (1443), (5265), (2690), (6017), (732), (6663), (2417), (3595), (1917), (7559), (6892), (809), (9985), (6776), (6296), (5360), (6871), (2365), (6249), (6991), (7903), (6079), (7085), (8565), (4246), (7416), (4893), (3182), (7673), (68), (1594), (2574), (3823), (3752), (2933), (3787), (4357), (102), (9843), (8954), (9969), (1596), (5506), (3926), (3674), (721), (1476), (722), (1680), (1694), (965), (1850), (3085), (9977), (6889), (103), (8546), (4712), (441), (6786), (6810), (9368), (4852), (7236), (9282), (2948), (8847), (8702), (3366), (7572), (6803), (8108), (4461), (1538), (1769), (1130), (9208), (4640), (613), (9363), (1507), (8648), (826), (4384), (5683), (660), (642), (9900), (4850), (6589), (2922), (8618), (2474), (4360), (686), (2230), (7499), (4000), (376), (8837), (1602), (1203), (344), (1841), (2721), (4999), (4457), (2528), (1571), (9821), (8962), (4653), (7901), (7568), (5318), (3190), (8463), (60), (9104), (4252), (9090), (9063), (5135), (3362), (6424), (3335), (462), (3361), (9513), (6294), (5796), (3676), (3967), (5450), (3401), (2313), (3304), (3991), (8384), (7893), (1238), (7146), (6302), (9779), (6871), (6303), (3502), (6753), (3791), (5745), (3101), (6826), (8037), (5006), (5716), (2959), (6327), (4539), (2623), (503), (6971), (6080), (7213), (17), (9431), (651), (5753), (8927), (8545), (9752), (217), (6066), (2080), (1853), (5039), (9402), (6258), (1391), (8612), (4359), (484), (2020), (4201), (165), (3141), (7586), (9947), (8084), (1939), (7072), (3979), (6919), (5042), (845), (6510), (2311), (5079), (9505), (4649), (70), (8683), (8555), (7748), (7910), (7002), (12), (5654), (2231), (8548), (4987), (1608), (5919), (7544), (7140), (7556), (3336), (9256), (4894), (9314), (1810), (1456), (1502), (1256), (8497), (3484), (4563), (5547), (4215), (7706), (3212), (5022), (7756), (8052), (2337), (8930), (9974), (9839), (3755), (3310), (9030), (9382), (9524), (9692), (7725), (3570), (1518), (2283), (2806), (7735), (9175), (3942), (5117), (680), (5234), (4264), (989), (1355), (4450), (3777), (1611), (8978), (7568), (2554), (1956), (3546), (5933), (708), (7875), (9865), (2479), (7690), (6083), (9134), (5962), (7222), (9988), (8691), (3633), (4342), (9882), (6858), (1595), (4427), (8658), (7425), (1544), (6642), (244), (9653), (7249), (1966), (4494), (4976), (8992), (704), (5446), (4648), (7128), (5585), (1936), (4629), (1784), (6236), (9814), (7397), (1132), (5429), (1587), (8740), (9005), (7377), (8401), (8682), (747), (1022), (5342), (8374), (82), (2755), (2105), (2699), (7128), (4364), (9478), (2577), (1244), (9995), (3466), (9364), (5729), (6097), (7263), (6512), (4495), (5835), (4907), (2948), (4438), (9103), (1216), (6251), (1563), (9195), (1770), (1710), (6858), (1254), (9616), (9577), (6075), (5182), (6381), (2181), (6132), (6010), (7977), (9553), (6311), (3720), (3732), (3152), (1400), (7713), (2923), (2004), (9323), (8990), (490), (5691), (6249), (9090), (427), (753), (6273), (3085), (5781), (721), (5653), (448), (5310), (5584), (2296), (9995), (1735), (9067), (4322), (1191), (9960), (7729), (1378), (7647), (2558), (3166), (1857), (3515), (5779), (8193), (3214), (7466), (3512), (250), (7456), (1174), (3150), (8428), (7959), (4894), (6954), (4759), (5951), (7126), (3752), (3815), (8623), (1850), (2120), (9243), (9856), (5231), (1243), (8187), (4314), (6812), (9647), (8397), (8328), (4627), (2840), (4989), (4161), (3199), (7754), (640), (3699), (2878), (6959), (5788), (554), (1027), (5307), (605), (8874), (1239), (8786), (8362), (4170), (655), (937), (5774), (10), (4197), (2642), (6502), (2133), (4688), (8636), (1455), (329), (3427), (2734), (4799), (1734), (6446), (6176); 

INSERT into purchases(userid, itemid, purchase_date)
VALUES
(9, 286, '6/24/2019'), (1, 409, '9/17/2020'), (72, 233, '8/17/2020'), (94, 404, '6/15/2019'), (95, 438, '9/26/2021'), (52, 343, '4/19/2020'), (47, 33, '3/12/2020'), (49, 430, '2/23/2020'), (93, 135, '12/15/2020'), (33, 282, '2/22/2021'), (83, 318, '10/1/2019'), (90, 150, '7/21/2020'), (80, 250, '10/8/2020'), (81, 267, '2/24/2019'), (47, 303, '10/3/2020'), (47, 423, '8/13/2020'), (79, 429, '9/7/2019'), (96, 190, '12/4/2021'), (95, 94, '9/11/2020'), (73, 286, '3/12/2020'), (8, 337, '12/20/2021'), (69, 51, '5/6/2021'), (21, 126, '3/9/2019'), (52, 147, '12/10/2019'), (60, 60, '11/10/2020'), (56, 398, '8/18/2021'), (6, 3, '6/26/2020'), (67, 390, '3/13/2019'), (63, 465, '11/23/2021'), (65, 185, '5/21/2021'), (90, 181, '9/20/2019'), (21, 274, '3/6/2021'), (88, 479, '7/26/2021'), (55, 228, '11/20/2021'), (23, 387, '6/23/2020'), (45, 100, '3/1/2019'), (57, 359, '8/28/2021'), (81, 131, '5/28/2020'), (8, 13, '3/16/2020'), (10, 1, '6/26/2019'), (32, 422, '2/5/2019'), (98, 207, '11/16/2019'), (48, 255, '9/13/2020'), (68, 268, '1/28/2021'), (67, 459, '12/19/2020'), (82, 154, '8/24/2019'), (12, 242, '7/10/2019'), (60, 156, '3/14/2021'), (45, 104, '7/2/2021'), (33, 371, '6/15/2021'), (96, 37, '4/12/2020'), (56, 215, '7/9/2020'), (12, 261, '11/7/2019'), (70, 81, '2/23/2020'), (42, 155, '12/5/2019'), (51, 362, '4/26/2019'), (89, 417, '4/22/2020'), (7, 136, '11/5/2021'), (16, 340, '7/25/2020'), (29, 141, '2/1/2021'), (46, 189, '5/26/2019'), (94, 60, '5/21/2019'), (32, 331, '3/27/2021'), (44, 69, '12/6/2019'), (82, 153, '6/28/2020'), (94, 461, '9/5/2021'), (55, 197, '4/6/2019'), (16, 352, '2/24/2019'), (38, 71, '2/28/2020'), (11, 476, '6/12/2020'), (44, 389, '3/17/2020'), (58, 66, '4/24/2020'), (56, 55, '1/28/2020'), (94, 364, '2/6/2020'), (17, 43, '10/26/2020'), (53, 394, '6/18/2019'), (81, 496, '10/5/2021'), (97, 432, '5/23/2019'), (32, 47, '5/20/2020'), (50, 297, '9/26/2020'), (33, 156, '5/19/2021'), (63, 244, '4/17/2019'), (67, 191, '3/25/2021'), (88, 408, '3/20/2021'), (31, 418, '12/24/2019'), (70, 289, '8/25/2019'), (9, 148, '4/8/2020'), (67, 469, '3/28/2021'), (66, 394, '2/25/2019'), (47, 489, '1/19/2020'), (83, 403, '7/4/2019'), (42, 171, '6/9/2019'), (33, 335, '8/5/2019'), (89, 84, '12/15/2020'), (56, 82, '10/10/2020'), (79, 155, '1/27/2021'), (90, 106, '3/27/2019'), (41, 298, '3/4/2019'), (37, 208, '12/22/2019'), (74, 65, '4/3/2020'), (99, 92, '3/28/2021'), (88, 58, '4/19/2021'), (44, 236, '7/23/2021'), (85, 73, '5/6/2020'), (45, 26, '12/6/2019'), (70, 7, '2/3/2021'), (73, 105, '1/27/2020'), (40, 149, '11/18/2019'), (86, 403, '10/21/2020'), (51, 406, '2/1/2019'), (56, 402, '9/9/2019'), (60, 470, '8/26/2020'), (22, 414, '11/22/2021'), (85, 138, '3/20/2019'), (75, 207, '7/17/2021'), (12, 29, '2/10/2019'), (86, 283, '8/5/2021'), (23, 77, '4/16/2019'), (19, 300, '2/16/2021'), (58, 422, '9/26/2021'), (78, 375, '11/25/2021'), (89, 208, '5/28/2021'), (56, 346, '11/8/2019'), (9, 97, '6/19/2021'), (14, 227, '6/8/2020'), (87, 338, '6/27/2020'), (34, 369, '8/22/2021'), (70, 273, '6/26/2021'), (67, 56, '12/15/2021'), (84, 448, '9/25/2019'), (47, 75, '1/11/2021'), (6, 114, '9/24/2021'), (32, 245, '12/23/2021'), (67, 132, '11/11/2019'), (20, 380, '12/11/2019'), (85, 85, '11/22/2019'), (90, 391, '11/4/2021'), (63, 71, '10/1/2020'), (1, 364, '3/24/2019'), (39, 210, '2/9/2020'), (3, 236, '12/28/2019'), (81, 187, '10/5/2019'), (57, 65, '1/12/2021'), (78, 139, '3/11/2021'), (47, 11, '4/18/2020'), (21, 133, '4/6/2021'), (18, 390, '3/7/2020'), (48, 294, '8/2/2020'), (45, 324, '11/25/2020'), (13, 306, '6/24/2021'), (34, 192, '7/22/2019'), (82, 92, '11/23/2020'), (79, 227, '10/19/2021'), (65, 429, '9/28/2019'), (92, 235, '2/13/2020'), (69, 473, '6/23/2019'), (32, 140, '11/11/2019'), (100, 51, '9/19/2020'), (82, 331, '12/19/2020'), (33, 215, '6/26/2021'), (74, 496, '10/16/2021'), (65, 35, '11/9/2021'), (41, 309, '1/15/2019'), (33, 106, '9/19/2021'), (29, 156, '11/1/2019'), (53, 116, '6/11/2019'), (71, 296, '1/28/2021'), (17, 375, '3/28/2021'), (24, 231, '3/23/2021'), (35, 45, '7/6/2019'), (97, 337, '3/12/2021'), (82, 85, '9/13/2021'), (73, 89, '8/6/2019'), (8, 235, '12/26/2021'), (71, 284, '11/17/2020'), (92, 166, '3/27/2020'), (63, 295, '7/19/2019'), (68, 404, '6/28/2020'), (2, 310, '1/12/2019'), (82, 108, '2/16/2019'), (84, 149, '6/11/2020'), (76, 132, '5/4/2021'), (18, 457, '2/12/2019'), (75, 262, '8/9/2020'), (61, 105, '11/21/2021'), (71, 162, '11/28/2019'), (82, 433, '3/2/2020'), (24, 473, '7/14/2021'), (57, 60, '10/28/2019'), (1, 439, '12/16/2021'), (41, 377, '8/25/2019'), (85, 282, '11/27/2021'), (88, 78, '2/24/2019'), (15, 472, '11/24/2019'), (51, 20, '3/26/2020'), (20, 398, '10/21/2020'), (94, 285, '6/12/2019'), (20, 167, '7/26/2021'), (14, 470, '3/10/2021'), (78, 334, '6/15/2021'), (95, 469, '4/9/2020'), (51, 182, '11/24/2019'), (1, 490, '3/21/2020'), (39, 161, '5/3/2020'), (24, 124, '6/15/2019'), (12, 255, '9/27/2021'), (61, 156, '7/15/2021'), (27, 208, '7/3/2019'), (56, 393, '6/12/2019'), (66, 457, '4/13/2020'), (29, 430, '6/7/2020'), (84, 222, '5/6/2019'), (53, 385, '11/28/2021'), (67, 328, '8/21/2021'), (40, 24, '4/22/2019'), (31, 247, '10/11/2019'), (9, 201, '9/22/2020'), (94, 294, '6/28/2019'), (83, 389, '2/16/2020'), (60, 454, '3/27/2019'), (90, 394, '7/12/2020'), (12, 176, '10/26/2020'), (2, 84, '2/10/2020'), (10, 39, '3/19/2019'), (76, 480, '3/14/2021'), (63, 177, '10/3/2019'), (18, 43, '12/14/2020'), (80, 278, '5/15/2021'), (32, 205, '3/23/2021'), (57, 478, '2/27/2019'), (33, 128, '10/12/2019'), (60, 168, '8/8/2021'), (46, 136, '4/19/2020'), (72, 482, '6/4/2020'), (88, 207, '5/13/2021'), (45, 379, '7/26/2019'), (95, 174, '9/28/2020'), (85, 303, '9/24/2019'), (13, 333, '9/13/2020'), (3, 54, '1/5/2020'), (48, 353, '7/19/2019'), (81, 336, '4/16/2020'), (63, 47, '11/7/2020'), (97, 9, '6/20/2020'), (75, 487, '7/8/2021'), (100, 357, '12/25/2021'), (64, 489, '3/13/2021'), (1, 360, '11/23/2020'), (16, 270, '4/5/2019'), (67, 271, '12/17/2021'), (13, 114, '11/23/2021'), (1, 468, '7/22/2021'), (9, 230, '1/12/2020'), (30, 429, '11/18/2019'), (63, 81, '6/28/2021'), (14, 404, '9/3/2021'), (28, 75, '9/12/2019'), (92, 67, '2/9/2020'), (56, 352, '8/11/2021'), (87, 174, '7/14/2021'), (87, 279, '4/8/2019'), (65, 370, '9/7/2019'), (24, 458, '5/21/2019'), (36, 126, '7/8/2019'), (91, 338, '6/2/2020'), (20, 174, '2/14/2020'), (34, 357, '6/26/2019'), (72, 76, '5/7/2021'), (19, 487, '9/18/2021'), (30, 285, '5/5/2019'), (66, 54, '10/26/2020'), (1, 161, '3/12/2020'), (15, 138, '8/25/2020'), (80, 454, '3/22/2019'), (38, 342, '10/2/2019'), (29, 344, '1/23/2020'), (82, 61, '10/12/2020'), (78, 362, '6/27/2021'), (23, 144, '12/12/2020'), (41, 468, '8/6/2020'), (29, 382, '8/2/2019'), (35, 423, '5/13/2019'), (57, 78, '2/12/2021'), (61, 412, '8/23/2019'), (83, 401, '3/14/2019'), (86, 107, '2/15/2019'), (35, 187, '4/27/2021'), (81, 155, '9/3/2019'), (71, 360, '7/7/2021'), (15, 354, '8/23/2020'), (72, 476, '7/20/2021'), (47, 244, '10/2/2019'), (92, 413, '10/26/2019'), (80, 72, '3/27/2020'), (18, 202, '2/7/2021'), (71, 475, '1/17/2019'), (64, 344, '2/12/2019'), (63, 271, '2/16/2019'), (56, 230, '3/23/2019'), (22, 57, '11/10/2020'), (29, 192, '11/14/2021'), (26, 190, '4/19/2020'), (96, 370, '11/17/2021'), (72, 404, '1/13/2021'), (12, 263, '12/15/2020'), (77, 360, '5/24/2020'), (71, 211, '11/10/2020'), (82, 94, '12/6/2021'), (19, 161, '9/4/2021'), (5, 301, '1/17/2021'), (18, 94, '1/9/2021'), (94, 348, '2/1/2020'), (46, 103, '6/9/2021'), (24, 14, '2/27/2019'), (87, 110, '2/5/2019'), (36, 129, '8/22/2021'), (32, 329, '7/24/2021'), (64, 117, '1/1/2020'), (14, 235, '6/13/2020'), (10, 365, '9/13/2021'), (83, 261, '2/22/2021'), (26, 399, '6/8/2019'), (8, 249, '11/25/2020'), (72, 117, '2/17/2020'), (58, 110, '11/11/2019'), (60, 241, '2/5/2019'), (50, 197, '2/23/2021'), (40, 381, '12/25/2019'), (65, 327, '6/18/2019'), (94, 188, '7/17/2019'), (28, 92, '12/21/2020'), (31, 166, '3/6/2019'), (25, 42, '1/14/2020'), (36, 81, '4/3/2021'), (67, 420, '3/1/2021'), (48, 88, '8/12/2019'), (55, 379, '8/6/2021'), (88, 35, '10/20/2020'), (38, 484, '12/11/2021'), (57, 296, '11/21/2020'), (68, 377, '8/24/2021'), (35, 74, '3/1/2019'), (51, 63, '12/26/2020'), (51, 423, '8/13/2021'), (1, 354, '9/18/2020'), (29, 312, '9/27/2019'), (29, 320, '4/6/2020'), (36, 186, '8/11/2019'), (55, 396, '5/7/2019'), (86, 312, '1/27/2019'), (21, 105, '8/14/2019'), (52, 186, '2/22/2021'), (81, 44, '12/13/2020'), (92, 221, '3/23/2021'), (19, 341, '12/7/2020'), (9, 204, '12/23/2019'), (9, 287, '1/13/2020'), (98, 131, '4/20/2019'), (84, 228, '10/16/2019'), (83, 433, '1/15/2021'), (82, 418, '1/10/2021'), (70, 121, '1/1/2019'), (12, 213, '10/4/2020'), (31, 244, '10/16/2019'), (87, 42, '4/22/2020'), (82, 460, '2/13/2021'), (35, 135, '12/6/2021'), (23, 213, '6/14/2020'), (11, 458, '2/23/2021'), (57, 248, '9/22/2019'), (80, 87, '6/6/2020'), (91, 495, '2/18/2019'), (9, 19, '5/15/2020'), (40, 33, '8/11/2021'), (92, 488, '8/12/2020'), (15, 363, '11/4/2020'), (80, 302, '6/14/2021'), (34, 256, '1/23/2021'), (30, 33, '1/19/2019'), (28, 224, '10/23/2020'), (61, 148, '6/4/2020'), (26, 480, '12/22/2021'), (41, 111, '11/27/2020'), (9, 63, '5/5/2020'), (24, 490, '9/24/2020'), (19, 77, '1/20/2020'), (47, 254, '2/13/2021'), (18, 466, '8/16/2020'), (25, 62, '7/11/2019'), (61, 109, '5/18/2019'), (35, 480, '4/7/2019'), (22, 203, '3/12/2021'), (33, 413, '6/19/2020'), (13, 83, '1/11/2020'), (69, 419, '10/27/2021'), (28, 181, '11/6/2021'), (97, 106, '2/10/2021'), (24, 171, '12/15/2021'), (46, 307, '9/1/2020'), (9, 251, '1/5/2021'), (67, 238, '12/7/2021'), (54, 415, '12/12/2019'), (15, 175, '7/5/2020'), (76, 304, '3/14/2019'), (64, 457, '6/27/2020'), (14, 14, '6/10/2021'), (65, 112, '6/15/2020'), (62, 4, '1/16/2019'), (53, 154, '1/8/2019'), (26, 13, '9/22/2019'), (97, 335, '3/22/2019'), (74, 84, '9/23/2020'), (23, 159, '3/15/2019'), (10, 97, '9/7/2019'), (13, 131, '8/19/2019'), (2, 4, '6/23/2020'), (8, 360, '6/22/2021'), (32, 185, '7/5/2019'), (3, 330, '6/15/2019'), (1, 268, '3/3/2019'), (98, 173, '2/13/2021'), (34, 289, '5/25/2020'), (41, 333, '2/5/2021'), (83, 81, '4/15/2021'), (79, 141, '7/15/2020'), (100, 199, '3/25/2019'), (20, 328, '6/16/2019'), (99, 416, '10/2/2019'), (14, 46, '7/14/2020'), (92, 378, '5/13/2020'), (26, 290, '8/26/2020'), (45, 491, '9/15/2019'), (29, 7, '4/10/2021'), (98, 182, '10/20/2020'), (92, 87, '5/14/2020'), (24, 405, '10/4/2020'), (62, 131, '6/17/2019'), (42, 361, '7/25/2019'), (72, 316, '10/25/2020'), (89, 127, '7/14/2021'), (1, 115, '4/10/2021'), (10, 62, '9/4/2021'), (47, 79, '4/5/2021'), (71, 247, '6/3/2020'), (47, 350, '8/6/2021'), (16, 83, '1/8/2020'), (76, 395, '9/1/2021'), (5, 23, '6/7/2020'), (43, 62, '4/19/2020'), (36, 55, '8/17/2021'), (78, 454, '3/12/2019'), (83, 382, '9/22/2021'), (100, 477, '2/18/2020'), (59, 414, '4/19/2020'), (92, 327, '6/14/2020'), (5, 178, '10/17/2021'), (62, 170, '1/22/2020'), (14, 278, '3/13/2020'), (54, 42, '3/9/2019'), (99, 83, '7/13/2021'), (83, 326, '4/1/2021'), (82, 126, '8/14/2021'), (12, 421, '10/20/2020'), (6, 212, '8/18/2021'), (47, 408, '7/2/2020'), (94, 341, '10/10/2020'), (55, 100, '5/1/2019'), (98, 21, '10/16/2021'), (13, 489, '11/8/2020'), (25, 487, '9/6/2021'), (94, 481, '12/27/2021'), (8, 123, '7/10/2021'), (36, 146, '3/26/2019'), (78, 258, '9/20/2020'), (15, 425, '11/9/2019'), (92, 455, '4/25/2021'), (80, 18, '10/16/2021'), (82, 242, '7/28/2020'), (27, 295, '6/27/2021'), (61, 357, '12/19/2020'), (9, 319, '1/6/2019'), (31, 154, '5/28/2021'), (74, 221, '4/3/2019'), (100, 337, '9/23/2019'), (82, 257, '1/25/2021'), (73, 276, '8/12/2021'), (37, 308, '1/23/2021'), (99, 138, '7/18/2019'), (65, 66, '8/26/2021'), (49, 52, '3/20/2020'), (47, 393, '5/20/2019'), (78, 363, '10/6/2019'), (83, 233, '3/5/2019'), (90, 165, '6/12/2021'), (20, 459, '2/17/2021'), (19, 1, '7/23/2021'), (87, 130, '8/2/2020'), (93, 138, '8/16/2019'), (42, 57, '10/21/2020'), (30, 175, '5/6/2021'), (57, 25, '4/5/2021'), (94, 338, '12/7/2020'), (83, 2, '4/3/2020'), (45, 161, '12/8/2021'), (22, 193, '9/10/2020'), (71, 284, '1/19/2020'), (73, 215, '2/16/2019'), (16, 166, '4/26/2019'), (3, 128, '9/11/2020'), (34, 161, '5/9/2020'), (23, 297, '4/14/2020'), (65, 433, '1/5/2020'), (58, 445, '6/15/2019'), (33, 377, '8/11/2021'), (62, 205, '10/22/2020'), (73, 500, '4/23/2020'), (46, 269, '8/24/2021'), (16, 251, '10/17/2021'), (75, 361, '4/27/2020'), (25, 409, '2/17/2021'), (83, 296, '3/6/2021'), (14, 310, '3/14/2021'), (30, 307, '8/14/2020'), (34, 97, '12/7/2021'), (52, 263, '7/25/2021'), (34, 237, '2/6/2019'), (43, 40, '2/16/2019'), (68, 268, '3/3/2019'), (23, 79, '9/4/2021'), (63, 229, '2/7/2021'), (44, 94, '11/17/2021'), (86, 55, '7/16/2019'), (79, 38, '9/14/2019'), (8, 218, '8/3/2020'), (95, 399, '6/7/2019'), (68, 67, '9/22/2020'), (42, 98, '6/14/2020'), (95, 241, '3/24/2019'), (93, 21, '3/11/2021'), (37, 286, '12/22/2020'), (13, 382, '3/24/2020'), (22, 169, '3/21/2021'), (12, 475, '1/6/2019'), (91, 482, '10/12/2021'), (15, 423, '10/21/2020'), (46, 132, '6/10/2021'), (47, 230, '4/28/2021'), (81, 233, '3/21/2021'), (26, 187, '1/26/2021'), (83, 404, '8/23/2020'), (55, 207, '1/11/2020'), (9, 404, '7/19/2019'), (38, 190, '11/17/2021'), (23, 346, '5/18/2020'), (86, 280, '11/18/2019'), (69, 471, '8/17/2019'), (84, 12, '6/6/2019'), (34, 216, '5/12/2021'), (94, 337, '8/24/2020'), (98, 290, '11/18/2019'), (13, 376, '6/28/2021'), (72, 375, '3/24/2020'), (90, 15, '9/20/2020'), (12, 228, '12/13/2021'), (25, 285, '6/22/2019'), (67, 500, '11/11/2020'), (13, 429, '5/11/2020'), (7, 435, '12/3/2021'), (29, 486, '5/22/2021'), (72, 177, '4/7/2021'), (27, 111, '7/17/2019'), (45, 473, '5/2/2019'), (58, 7, '4/21/2021'), (50, 327, '8/28/2020'), (57, 349, '11/26/2020'), (48, 28, '3/14/2020'), (90, 52, '4/28/2020'), (8, 352, '2/1/2021'), (25, 151, '5/9/2021'), (79, 372, '11/4/2019'), (72, 267, '1/11/2019'), (23, 454, '4/20/2021'), (9, 241, '7/25/2020'), (87, 390, '12/17/2020'), (90, 123, '1/23/2020'), (71, 455, '5/22/2020'), (41, 393, '8/9/2020'), (84, 454, '2/11/2020'), (100, 21, '9/11/2019'), (22, 93, '11/8/2019'), (17, 249, '4/25/2019'), (15, 425, '12/10/2021'), (19, 253, '10/5/2020'), (38, 330, '1/7/2021'), (34, 36, '5/7/2021'), (88, 22, '8/15/2021'), (38, 294, '11/26/2019'), (13, 109, '3/26/2021'), (38, 18, '9/20/2020'), (96, 173, '10/7/2020'), (11, 455, '2/14/2021'), (21, 310, '4/3/2021'), (49, 70, '12/28/2020'), (5, 319, '7/6/2021'), (44, 479, '7/17/2021'), (92, 399, '7/14/2020'), (41, 468, '8/11/2020'), (12, 242, '9/8/2019'), (35, 455, '6/6/2020'), (9, 178, '11/3/2021'), (56, 198, '6/1/2019'), (47, 252, '3/2/2019'), (96, 49, '11/9/2020'), (98, 354, '5/25/2021'), (5, 25, '1/27/2020'), (60, 252, '10/22/2019'), (56, 422, '1/27/2020'), (9, 260, '10/26/2020'), (57, 403, '6/25/2021'), (50, 179, '6/25/2020'), (72, 176, '9/1/2020'), (41, 25, '4/12/2021'), (73, 294, '10/18/2020'), (41, 258, '5/27/2020'), (59, 318, '3/16/2021'), (73, 195, '6/3/2019'), (25, 57, '10/14/2020'), (69, 211, '4/23/2020'), (38, 200, '9/14/2021'), (23, 68, '1/9/2019'), (8, 364, '8/16/2021'), (53, 441, '9/12/2020'), (22, 451, '1/7/2020'), (33, 42, '12/4/2021'), (51, 32, '6/23/2021'), (2, 158, '8/11/2021'), (77, 155, '1/14/2019'), (70, 410, '7/16/2020'), (74, 245, '6/4/2019'), (88, 437, '10/21/2020'), (36, 396, '4/4/2020'), (29, 189, '1/20/2019'), (55, 220, '12/13/2020'), (17, 462, '6/7/2019'), (82, 311, '10/20/2020'), (82, 49, '4/19/2019'), (59, 391, '12/3/2019'), (41, 199, '12/7/2019'), (45, 171, '7/17/2021'), (72, 265, '12/8/2020'), (97, 213, '3/19/2019'), (17, 120, '1/7/2021'), (78, 52, '9/21/2020'), (3, 467, '9/6/2021'), (43, 346, '6/19/2021'), (15, 418, '12/5/2019'), (25, 469, '3/4/2021'), (63, 65, '7/27/2021'), (93, 405, '6/15/2020'), (61, 231, '12/7/2021'), (39, 242, '6/10/2019'), (66, 292, '11/10/2021'), (84, 365, '4/10/2021'), (3, 467, '8/4/2021'), (45, 441, '2/16/2020'), (88, 222, '11/27/2021'), (63, 473, '6/19/2021'), (18, 412, '1/19/2019'), (24, 106, '7/10/2021'), (77, 409, '6/20/2021'), (75, 403, '10/7/2020'), (81, 486, '7/4/2019'), (68, 206, '8/12/2020'), (46, 339, '11/27/2021'), (82, 431, '5/15/2019'), (64, 151, '1/12/2019'), (14, 380, '5/4/2019'), (81, 96, '8/25/2020'), (45, 147, '9/5/2020'), (96, 268, '10/27/2019'), (67, 113, '6/17/2020'), (64, 299, '4/6/2020'), (5, 103, '2/10/2020'), (5, 348, '4/19/2019'), (34, 92, '9/11/2019'), (3, 305, '12/2/2021'), (95, 261, '8/10/2021'), (89, 317, '11/19/2021'), (27, 55, '3/22/2020'), (78, 123, '1/7/2020'), (52, 328, '10/15/2019'), (51, 316, '1/27/2020'), (9, 49, '10/9/2019'), (39, 489, '4/12/2020'), (54, 223, '5/28/2019'), (73, 241, '3/1/2019'), (59, 11, '4/21/2019'), (61, 225, '1/4/2021'), (60, 150, '9/21/2020'), (46, 86, '2/9/2021'), (45, 227, '8/2/2021'), (71, 37, '10/21/2020'), (71, 331, '10/4/2019'), (77, 420, '12/22/2020'), (39, 85, '1/11/2021'), (63, 388, '6/16/2021'), (66, 360, '10/20/2019'), (8, 188, '12/3/2021'), (79, 176, '1/15/2021'), (34, 500, '1/2/2021'), (36, 138, '6/27/2019'), (33, 88, '9/21/2019'), (39, 406, '4/16/2019'), (41, 136, '3/22/2021'), (82, 73, '6/8/2019'), (57, 318, '2/18/2021'), (13, 261, '12/10/2021'), (44, 35, '4/24/2019'), (73, 370, '12/16/2020'), (73, 172, '12/8/2019'), (29, 269, '9/13/2020'), (95, 150, '4/13/2020'), (82, 183, '9/2/2020'), (64, 361, '5/27/2019'), (92, 321, '12/2/2019'), (89, 368, '8/13/2020'), (28, 486, '4/13/2021'), (76, 372, '5/5/2019'), (89, 18, '1/11/2021'), (84, 107, '2/4/2019'), (12, 196, '9/13/2021'), (86, 140, '10/6/2021'), (6, 398, '6/7/2020'), (64, 236, '12/8/2020'), (85, 499, '6/14/2019'), (45, 225, '6/20/2020'), (43, 430, '3/15/2019'), (34, 39, '7/26/2020'), (93, 191, '5/9/2020'), (60, 31, '11/22/2019'), (98, 25, '12/22/2020'), (59, 76, '1/16/2021'), (86, 363, '9/6/2021'), (49, 16, '12/7/2020'), (29, 107, '10/25/2021'), (54, 37, '3/3/2021'), (13, 421, '12/18/2021'), (25, 128, '8/16/2020'), (77, 323, '1/7/2020'), (91, 347, '8/8/2019'), (3, 138, '3/25/2019'), (22, 323, '6/27/2021'), (69, 481, '9/2/2020'), (72, 249, '12/6/2020'), (40, 31, '10/3/2019'), (44, 95, '4/16/2020'), (71, 243, '10/25/2019'), (82, 295, '8/17/2019'), (14, 306, '11/12/2019'), (87, 17, '1/21/2021'), (46, 406, '10/13/2020'), (75, 421, '1/14/2019'), (48, 69, '8/14/2021'), (24, 245, '5/15/2020'), (87, 252, '6/17/2020'), (3, 307, '12/20/2020'), (15, 370, '5/14/2021'), (11, 160, '11/11/2021'), (31, 366, '4/18/2021'), (98, 166, '9/6/2021'), (52, 275, '11/26/2019'), (71, 173, '10/22/2019'), (8, 293, '9/12/2021'), (70, 370, '10/7/2020'), (3, 65, '4/4/2021'), (16, 482, '6/5/2020'), (46, 189, '2/9/2020'), (76, 437, '5/3/2021'), (62, 93, '8/20/2021'), (74, 357, '4/15/2021'), (69, 378, '2/9/2019'), (71, 228, '4/19/2019'), (83, 321, '8/11/2020'), (100, 472, '11/14/2020'), (75, 380, '12/3/2021'), (44, 354, '5/12/2019'), (9, 394, '7/21/2019'), (31, 265, '5/12/2019'), (90, 198, '11/15/2021'), (97, 109, '5/7/2021'), (33, 191, '8/1/2020'), (51, 70, '4/27/2019'), (30, 202, '2/27/2020'), (19, 97, '1/17/2021'), (91, 161, '7/28/2019'), (54, 390, '4/2/2021'), (12, 143, '3/15/2021'), (95, 350, '3/13/2020'), (40, 141, '5/1/2021'), (91, 103, '5/22/2019'), (11, 280, '11/3/2020'), (95, 255, '4/13/2019'), (71, 287, '5/27/2019'), (77, 456, '2/20/2019'), (5, 427, '3/10/2020'), (45, 290, '11/4/2021'), (41, 14, '7/24/2019'), (70, 306, '5/3/2020'), (57, 328, '6/19/2021'), (53, 154, '7/9/2020'), (40, 106, '2/6/2020'), (47, 417, '2/4/2020'), (9, 392, '7/28/2020'), (95, 435, '12/25/2020'), (51, 274, '12/28/2021'), (24, 247, '9/10/2019'), (78, 46, '8/4/2019'), (44, 466, '4/13/2020'), (49, 413, '9/12/2020'), (4, 254, '3/17/2019'), (22, 472, '2/14/2020'), (70, 17, '12/8/2019'), (68, 141, '11/1/2019'), (98, 304, '10/8/2020'), (6, 247, '6/23/2021'), (65, 347, '6/8/2020'), (43, 327, '12/11/2020'), (8, 378, '12/6/2021'), (55, 134, '1/8/2021'), (100, 344, '9/8/2020'), (76, 239, '6/12/2019'), (29, 116, '10/2/2020'), (16, 435, '3/24/2020'), (100, 203, '11/25/2021'), (49, 161, '2/14/2020'), (30, 321, '11/25/2019'), (40, 164, '3/28/2020'), (33, 127, '10/17/2021'), (65, 439, '1/10/2020'), (19, 320, '10/14/2021'), (69, 219, '8/4/2019'), (72, 433, '9/11/2021'), (31, 100, '10/8/2020'), (30, 59, '9/7/2021'), (50, 319, '11/2/2021'), (76, 159, '5/26/2020'), (31, 186, '7/10/2020'), (92, 439, '12/7/2021'), (41, 67, '5/5/2021'), (9, 32, '10/27/2020'), (18, 484, '10/4/2020'), (40, 401, '5/21/2019'), (94, 40, '3/24/2021'), (80, 422, '10/14/2020'), (35, 228, '6/23/2021'), (54, 78, '6/11/2020'), (66, 189, '5/14/2019'), (8, 70, '2/17/2021'), (72, 12, '9/8/2019'), (54, 295, '9/14/2020'), (14, 348, '9/16/2019'), (63, 437, '6/28/2021'), (29, 216, '4/4/2020'), (68, 435, '3/13/2019'), (17, 454, '6/14/2021'), (53, 38, '3/10/2021'), (8, 168, '3/8/2021'), (53, 232, '7/14/2020'), (60, 234, '1/10/2021'), (99, 24, '12/26/2019'), (26, 44, '9/1/2019'), (2, 260, '4/24/2019'), (23, 225, '9/13/2021'), (69, 310, '10/27/2019'), (83, 248, '4/6/2020'), (5, 320, '9/26/2020'), (7, 284, '5/21/2020'), (15, 3, '5/14/2019'), (97, 355, '1/28/2021'), (81, 339, '6/18/2020'), (45, 240, '10/26/2020'), (33, 499, '4/2/2020'), (40, 171, '1/6/2019'), (83, 91, '4/24/2021'), (37, 33, '2/2/2021'), (48, 300, '12/14/2020'), (95, 95, '8/7/2021'), (64, 272, '10/17/2019'), (100, 55, '2/13/2019'), (30, 81, '1/22/2019'), (6, 133, '1/12/2019'), (4, 145, '9/25/2020'), (13, 420, '10/3/2019'), (6, 232, '9/21/2021'), (29, 290, '3/20/2020'), (4, 336, '1/20/2019'), (1, 294, '1/7/2020'), (51, 416, '3/1/2019'), (9, 211, '3/15/2020'), (100, 88, '2/18/2019'), (99, 36, '10/16/2019'), (83, 426, '8/5/2021'), (74, 485, '9/6/2020'), (100, 438, '12/4/2019'), (78, 407, '3/17/2019'), (73, 155, '10/28/2019'), (43, 189, '9/24/2020'), (75, 264, '10/17/2021'), (38, 433, '9/3/2021'), (89, 471, '10/5/2019'), (83, 193, '10/6/2020'), (91, 334, '12/1/2020'), (79, 70, '10/6/2020'), (44, 410, '12/12/2020'), (80, 128, '7/6/2019'), (58, 59, '9/26/2021'), (80, 486, '4/11/2020'), (52, 416, '10/26/2020'), (28, 60, '6/13/2021'), (48, 293, '1/28/2020'), (11, 278, '7/4/2021'), (57, 281, '8/11/2020'), (51, 387, '1/11/2020'), (30, 388, '1/6/2019'), (65, 108, '6/11/2019'), (39, 268, '2/12/2020'), (35, 419, '9/13/2019'), (1, 408, '10/12/2019'), (93, 329, '8/25/2021'), (16, 207, '1/14/2021'), (99, 356, '6/26/2021'), (21, 214, '4/24/2019'), (39, 129, '4/21/2021'), (30, 438, '2/25/2020'), (69, 210, '5/2/2020'), (92, 153, '3/16/2020'), (85, 199, '12/21/2019'), (94, 235, '8/26/2020'), (70, 212, '2/9/2019'), (62, 369, '1/22/2021'), (91, 444, '12/22/2021'), (65, 226, '7/28/2020'), (34, 99, '3/24/2019'), (86, 275, '11/1/2019'), (44, 491, '7/1/2021'), (43, 434, '6/27/2020'), (50, 286, '5/7/2020'), (42, 33, '5/9/2020'), (37, 110, '6/21/2019'), (42, 140, '8/25/2020'), (52, 105, '12/12/2021'), (90, 412, '3/11/2020'), (76, 187, '4/8/2021'), (79, 178, '3/11/2019'), (40, 326, '8/16/2019'), (51, 361, '10/2/2021'), (55, 24, '6/7/2020'), (10, 159, '11/14/2019'), (70, 106, '8/19/2021'), (61, 390, '10/18/2019'), (48, 471, '5/4/2021'), (49, 32, '2/11/2021'), (42, 491, '8/21/2019'), (60, 154, '7/12/2019'), (50, 251, '4/24/2021'), (74, 51, '2/23/2020'), (40, 458, '3/21/2021'), (61, 13, '4/4/2020'), (75, 63, '5/4/2019'), (53, 7, '12/2/2021'), (31, 182, '4/13/2020'), (10, 344, '10/18/2020'), (56, 275, '12/14/2021'), (99, 324, '2/5/2019'), (45, 203, '12/12/2021'), (1, 439, '7/22/2020'), (5, 367, '5/14/2020'), (90, 324, '5/25/2020'), (55, 29, '1/3/2021'), (7, 274, '5/20/2020'), (14, 299, '12/22/2021'), (80, 268, '8/6/2021'), (56, 190, '7/23/2021'), (72, 266, '11/10/2021'), (28, 261, '4/8/2020'), (82, 86, '1/19/2020'), (26, 313, '1/20/2020'), (30, 181, '1/13/2021'), (10, 460, '5/5/2019'), (29, 225, '2/1/2020'), (23, 351, '5/21/2019'), (98, 27, '1/23/2021'), (99, 177, '11/5/2021'), (40, 290, '3/6/2021'), (84, 308, '8/8/2021'), (14, 331, '12/3/2019'), (4, 310, '8/18/2020'), (81, 100, '10/16/2019'), (88, 457, '2/25/2021'), (67, 148, '7/19/2019');

--A)какую сумму в среднем в месяц тратит:
--1)пользователи в возрастном диапазоне от 18 до 25 лет включительно:
SELECT p.userid,
u.age,
to_char(p.purchase_date,'Mon') as month, 
round(AVG(i.price), 2)
from purchases p
join users u on u.userid = p.userid
join items i on i.itemid = p.itemid
where u.age >= 18 and u.age <= 25
group by p.userid, u.age, to_char(p.purchase_date,'Mon');

--1)пользователи в возрастном диапазоне от 26 до 35 лет включительно:
SELECT p.userid,
u.age,
to_char(p.purchase_date,'Mon') as month, 
round(AVG(i.price), 2)
from purchases p
join users u on u.userid = p.userid
join items i on i.itemid = p.itemid
where u.age >= 26 and u.age <= 35
group by p.userid, u.age, to_char(p.purchase_date,'Mon');

--Б) в каком месяце года выручка от пользователей в возрастном диапазоне 35+ самая большая

SELECT
to_char(p.purchase_date,'Mon-YY') as MY,
sum(i.price) as sum_month
from purchases p
join users u on u.userid = p.userid
join items i on i.itemid = p.itemid
where u.age > 35
group by MY
Order by sum_month DESC
limit 1;

--В)какой товар обеспечивает дает наибольший вклад в выручку за последний год

SELECT
i.itemid,
sum(i.price) as "SumPrice"
from items i
join (
  SELECT
  p.itemid
  from purchases p
  WHERE to_char(p.purchase_date,'YY-Mon') LIKE '21%') as fp
on fp.itemid = i.itemid
GROUP by i.itemid
ORDER by "SumPrice" desc
limit 1;

--Г) топ-3 товаров по выручке и их доля в общей выручке за любой год

SELECT
i.itemid,
sum(i.price) as "SumPrice",
sum(i.price) / (
  select
  sum(i.price)::FLOAT
  from purchases p
  join items i on i.itemid = p.itemid
  WHERE to_char(p.purchase_date,'YY-Mon') LIKE '19%') as "ShareOfProceed" 
from purchases p
join items i on i.itemid = p.itemid
WHERE to_char(p.purchase_date,'YY-Mon') LIKE '19%'
GROUP by i.itemid
ORDER by "SumPrice" desc
limit 3;


